<turbo-frame id="content">
    <section class="pta-module" data-pta-view="graficas">

        {# ===============================
           HEADER SUPERIOR
           =============================== #}
        <header class="pta-module__header">

            <div class="pta-module__header-left">
                <a href="{{ path('app_encabezado_show', { id: encabezado.id }) }}"
                   data-turbo-frame="content"
                   class="pta-back-btn">
                    <i class="bi bi-arrow-left"></i>
                    <span>Volver</span>
                </a>
            </div>

            <h1 class="pta-module__title">
                üìä Gr√°ficas del PTA
            </h1>

        </header>

        {# ===============================
           CONTENIDO
           =============================== #}
        <div class="pta-module__content">

            {% for grafica in graficas %}

                <div class="card pta-card mb-4">

                    {# -------- HEADER DEL INDICADOR -------- #}
                    <div class="pta-card__header pta-indicador-header">

                        <div class="pta-indicador-main">
                            <h3 class="pta-indicador-title">
                                {{ grafica.indicador }}
                            </h3>
                        </div>

                        <div class="pta-indicador-stats">

                            <div class="pta-stat">
                                <span class="pta-stat-label">Meta</span>
                                <span class="pta-stat-value">{{ grafica.meta }}</span>
                            </div>

                            <div class="pta-stat">
                                <span class="pta-stat-label">Tendencia</span>
                                {% if grafica.tendencia == 'POSITIVA' %}
                                    <span class="pta-badge pta-badge-positiva">Positiva</span>
                                {% else %}
                                    <span class="pta-badge pta-badge-negativa">Negativa</span>
                                {% endif %}
                            </div>
                            <div class="pta-stat">
                                <span class="pta-stat-label">Avance</span>
                                <span class="pta-stat-value">
                                    {{ grafica.porcentaje }}%
                                </span>
                            </div>


                        </div>
                    </div>

                    {# -------- BODY: GR√ÅFICA -------- #}
                    <div class="pta-card__body">
                        <canvas
                            class="pta-chart"
                            data-indicador="{{ grafica.indicador }}"
                            data-meta="{{ grafica.meta }}"
                            data-tendencia="{{ grafica.tendencia }}"
                            data-meses='{{ grafica.meses|json_encode|raw }}'>
                        </canvas>
                    </div>

                    <div class="pta-actions">

                        {% for accion in grafica.acciones %}

                            <div class="pta-action-card">

                                <div class="pta-action-header">
                                    <strong>{{ accion.nombre }}</strong>
                                    <span>{{ accion.porcentaje }}%</span>
                                </div>

                                <div class="pta-action-bar">
                                    <div class="pta-action-bar-fill"
                                        style="width: {{ accion.porcentaje }}%"></div>
                                </div>

                                <div class="pta-action-months">
                                    {% for mes, valor in accion.meses %}
                                        <span>
                                            <strong>{{ mes|slice(0,3) }}</strong>: {{ valor }}
                                        </span>
                                    {% endfor %}
                                </div>

                            </div>

                        {% endfor %}

                    </div>


                </div>

            {% else %}
                <div class="text-center text-muted">
                    No hay indicadores para mostrar.
                </div>
            {% endfor %}

        </div>

    </section>
</turbo-frame>
